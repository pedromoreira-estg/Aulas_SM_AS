package  {		import flash.display.MovieClip;	import flash.events.Event;	import flash.events.KeyboardEvent;	import flash.ui.Keyboard;			public class Pong extends MovieClip {				// sons		var somArbitro = new referee();		var somRaquete = new ballkick();		var somParede  = new ballimpact();				// bola e raquetes e marcador		var bola 			: Bola;		var raqueteE 	: Raquete;		var raqueteD  : Raquete;		var marcador  : Marcador;				// teclas		// cima - u  e baixo-d para raquete da esquerda D 		var kuE = false;		var kdE = false;				// cima - u  e baixo-d para raquete da direita D 		var kuD = false;		var kdD = false;						// deslocamento da bola		var bolaVX;		var bolaVY;				const scaleBola = 0.2;				// maximo valor absoluto da componente do deslocamento		// em cada componente de direção		const MAXV = 25;				// afastamento da raquete à parede		const RDX  = 20;				// marcador		var golosE = 0;		var golosD = 0;				public function Pong() {			// init da bola e raquetes			initPong();			// registar o evento enter frame			addEventListener(Event.ENTER_FRAME,updatePong);			stage.addEventListener(KeyboardEvent.KEY_DOWN, updateKeysDOWN);			stage.addEventListener(KeyboardEvent.KEY_UP, updateKeysUP);		}				// criar uma bola		// coloca-la no centro do stage		private function initPong() {			// nova bola			bola = new Bola();			bola.x = stage.stageWidth/2;			bola.y = stage.stageHeight/2;			bola.scaleX = bola.scaleY = scaleBola;			addChild(bola);			makeV();						// init raquete Esquerda			raqueteE = new Raquete();			raqueteE.x = RDX;			raqueteE.y = stage.stageHeight/2;			addChild(raqueteE);						// init raquete Direita			raqueteD = new Raquete();			raqueteD.x = stage.stageWidth - RDX;			raqueteD.y = stage.stageHeight/2;			addChild(raqueteD);						// init marcador			marcador = new Marcador();			marcador.scaleX = marcador.scaleY = 0.6;			marcador.x = stage.stageWidth /2;			raqueteD.y = 0;			addChildAt(marcador,0);			marcador.GE.text = golosE.toString();			marcador.GD.text = golosD.toString();								}				function bolaCentro(e,d) {			golosE += e;			golosD += d;			marcador.GE.text = golosE.toString();			marcador.GD.text = golosD.toString();			// fim de jogo? //			trace("Santa Eulália FC :"+golosE.toString()+"-vs-"+golosD.toString()+":A.D.Chafé");			bola.x = stage.stageWidth/2;			bola.y = stage.stageHeight/2;			makeV();		}				private function makeV() {			bolaVX = (Math.random() * 2 * MAXV) - MAXV;			bolaVY = (Math.random() * 2 * MAXV) - MAXV ;		}				private function updateKeysDOWN(e:KeyboardEvent) {			// esquerda a->up z->down			if (e.keyCode == Keyboard.S) {				kuE = true;			}			if (e.keyCode == Keyboard.X) {				kdE = true;			}			if (e.keyCode == Keyboard.K) {				kuD = true;			}			if (e.keyCode == Keyboard.M) {				kdD = true;			}		}		private function updateKeysUP(e:KeyboardEvent) {			// esquerda a->up z->down			if (e.keyCode == Keyboard.S) {				kuE = false;			}			if (e.keyCode == Keyboard.X) {				kdE = false;			}			if (e.keyCode == Keyboard.K) {				kuD = false;			}			if (e.keyCode == Keyboard.M) {				kdD = false;			}		}		private function updatePong(e:Event) {			updateRaquetes();			// mexer a bola			moveBola();			// paredes			golo();			colideRaquetes();			colideParede();		}				private function updateRaquetes() {			//raqueteE.y = mouseY;						if (kuE) raqueteE.y -= 6;			if (kdE) raqueteE.y += 6;						if (kuD) raqueteD.y -= 6;			if (kdD) raqueteD.y += 6;		}				private function moveBola() {			bola.x += bolaVX;			bola.y += bolaVY;		}				private function colideRaquetes() {			if (bola.hitTestObject(raqueteE)) {				bolaVX *= -1;				bola.x = raqueteE.x + raqueteE.width/2 + bola.width/2;				somRaquete.play();			} else if (bola.hitTestObject(raqueteD)){				bolaVX *= -1;				bola.x = raqueteD.x - raqueteD.width/2 - bola.width/2;				somRaquete.play();			}						}		private function colideParede() {			// parede cima			if (bola.y < 0 + bola.height / 2) {				bolaVY *= -1;				bola.y = bola.height / 2;				somParede.play();			}			// baixo			if (bola.y > stage.stageHeight - bola.height / 2 ) {				bolaVY *= -1;				bola.y = stage.stageHeight - bola.height / 2;				somParede.play();			}		}				function golo() {						// esquerda			if (bola.x < bola.width / 2 ) {				bolaVX *= -1;				bola.x = bola.width / 2;				somArbitro.play();				bolaCentro(0,1);			}						// direita			if (bola.x > stage.stageWidth - bola.width / 2) {				bolaVX *= -1;				bola.x = stage.stageWidth - bola.width / 2;				somArbitro.play();				bolaCentro(1,0);			}		}	}}